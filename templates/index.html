<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DUFIL Food Analyzer</title>
    <!-- Premium Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap"
        rel="stylesheet">

    <style>
        :root {
            --primary: #2c4563;
            --primary-dark: #1a2a3a;
            --accent: #ffc107;
            --accent-hover: #ffb300;
            --bg-gradient: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            --glass-bg: rgba(255, 255, 255, 0.95);
            --glass-border: 1px solid rgba(255, 255, 255, 0.5);
            --shadow-sm: 0 4px 6px rgba(0, 0, 0, 0.05);
            --shadow-lg: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --radius-lg: 24px;
            --radius-md: 16px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Outfit', sans-serif;
            background: #f0f2f5;
            background-image:
                radial-gradient(at 0% 0%, hsla(253, 16%, 7%, 1) 0, transparent 50%),
                radial-gradient(at 50% 0%, hsla(225, 39%, 30%, 1) 0, transparent 50%),
                radial-gradient(at 100% 0%, hsla(339, 49%, 30%, 1) 0, transparent 50%);
            background-size: 100% 100%;
            background-attachment: fixed;
            color: #1f2937;
            min-height: 100vh;
        }

        /* Header */
        .header {
            background: rgba(44, 69, 99, 0.95);
            backdrop-filter: blur(12px);
            color: white;
            padding: 15px 0;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo-text {
            font-size: 24px;
            font-weight: 800;
            color: var(--accent);
            letter-spacing: -0.5px;
        }

        .nav {
            display: flex;
            gap: 30px;
        }

        .nav a {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            font-weight: 600;
            padding: 8px 16px;
            border-radius: 20px;
            transition: all 0.3s;
        }

        .nav a:hover,
        .nav a.active {
            color: white;
            background: rgba(255, 255, 255, 0.1);
        }

        .search-box {
            display: flex;
            align-items: center;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 8px 16px;
            width: 250px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s;
        }

        .search-box:focus-within {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.4);
        }

        .search-box input {
            border: none;
            outline: none;
            width: 100%;
            padding: 5px;
            background: transparent;
            color: white;
            font-family: 'Outfit', sans-serif;
        }

        .search-box input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        /* Container */
        .container {
            max-width: 1200px;
            margin: 30px auto;
            padding: 0 20px;
        }

        /* Main Section */
        .main-section {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        /* Common Card Styles */
        .upload-card,
        .preview-section,
        .ingredients-section,
        .analysis-section,
        .feature-card {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(12px);
            border-radius: var(--radius-lg);
            padding: 30px;
            box-shadow: var(--shadow-lg);
            border: 1px solid rgba(255, 255, 255, 0.6);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 25px 30px -5px rgba(0, 0, 0, 0.1);
        }

        .upload-card h1 {
            font-size: 32px;
            margin-bottom: 15px;
            color: var(--primary);
            font-weight: 800;
            letter-spacing: -1px;
        }

        .upload-card p {
            color: #64748b;
            margin-bottom: 30px;
            font-size: 1.1rem;
        }

        .upload-area {
            background: linear-gradient(135deg, #FFC107 0%, #FF9800 100%);
            border-radius: var(--radius-md);
            padding: 40px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 20px;
            border: 2px solid transparent;
            box-shadow: 0 10px 20px rgba(255, 152, 0, 0.2);
        }

        .upload-area:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(255, 152, 0, 0.3);
        }

        .upload-area.dragging {
            border-color: var(--primary);
            transform: scale(1.02);
        }

        .upload-icon-circle {
            width: 100px;
            height: 100px;
            background: white;
            border-radius: 50%;
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
        }

        .upload-icon-circle svg {
            width: 50px;
            height: 50px;
            fill: var(--primary);
        }

        .upload-text {
            color: white;
            font-weight: 700;
            margin-bottom: 5px;
            font-size: 1.2rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .upload-formats {
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
        }

        #imageInput {
            display: none;
        }

        .change-image-btn {
            background: white;
            color: var(--primary);
            border: 2px solid var(--primary);
            padding: 12px 24px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 700;
            transition: all 0.3s;
            font-family: 'Plus Jakarta Sans', sans-serif;
        }

        .change-image-btn:hover {
            background: var(--primary);
            color: white;
        }

        .preview-image {
            width: 100%;
            border-radius: var(--radius-md);
            margin-bottom: 20px;
            box-shadow: var(--shadow-sm);
        }

        .indomie-badge {
            background: var(--primary);
            color: white;
            padding: 12px 24px;
            border-radius: 50px;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            font-weight: 700;
            box-shadow: 0 4px 12px rgba(44, 69, 99, 0.3);
        }

        /* Banner Section */
        .banner-section {
            background: linear-gradient(135deg, #2c4563 0%, #1a2a3a 100%);
            border-radius: var(--radius-lg);
            padding: 50px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
            box-shadow: 0 20px 40px rgba(44, 69, 99, 0.3);
            position: relative;
            overflow: hidden;
        }

        .banner-section::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            background: radial-gradient(circle at top right, rgba(255, 193, 7, 0.2), transparent 40%);
        }

        .banner-item {
            color: white;
            position: relative;
            z-index: 1;
        }

        .banner-item h3 {
            font-size: 24px;
            margin-bottom: 10px;
            font-weight: 800;
            color: var(--accent);
        }

        .banner-item p {
            opacity: 0.8;
            font-size: 1.1rem;
        }

        /* Features */
        .features {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 30px;
            margin-bottom: 40px;
        }

        .feature-card h3 {
            color: var(--primary);
            margin-bottom: 10px;
            font-weight: 700;
            font-size: 1.2rem;
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
            margin-top: 20px;
        }

        .btn {
            padding: 14px 30px;
            border: none;
            border-radius: 12px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-family: 'Plus Jakarta Sans', sans-serif;
            font-size: 1rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, #2c4563 0%, #1a2a3a 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(44, 69, 99, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(44, 69, 99, 0.4);
        }

        .btn-secondary {
            background: white;
            color: var(--primary);
            border: 2px solid #e2e8f0;
        }

        .btn-secondary:hover {
            border-color: var(--primary);
            background: #f8fafc;
        }

        /* Ingredients Section */
        .ingredients-section {
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            display: none;
        }

        .ingredients-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .ingredients-header h2 {
            color: #2c4563;
            font-size: 20px;
        }

        .add-btn {
            background: transparent;
            color: #2c4563;
            border: none;
            padding: 8px 16px;
            cursor: pointer;
            font-weight: 600;
            font-size: 18px;
        }

        .ingredient-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .ingredient-item input {
            flex: 1;
            border: 1px solid #ddd;
            padding: 10px;
            border-radius: 5px;
            font-size: 15px;
        }

        .ingredient-item input:focus {
            outline: none;
            border-color: #2c4563;
        }

        .edit-icon,
        .delete-icon {
            cursor: pointer;
            color: #666;
            font-size: 18px;
            padding: 5px;
        }

        .edit-icon:hover {
            color: #2c4563;
        }

        .delete-icon:hover {
            color: #f44336;
        }

        .reset-save-buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .icon-btn {
            flex: 1;
            background: white;
            border: 2px solid #ddd;
            padding: 12px;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-weight: 600;
            transition: all 0.3s;
        }

        .icon-btn:hover {
            border-color: #2c4563;
            color: #2c4563;
        }

        /* Analysis Section */
        .analysis-section {
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            display: none;
        }

        .analysis-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .analysis-header h2 {
            color: #2c4563;
            font-size: 24px;
            margin-bottom: 15px;
        }

        /* Health Score Bar */
        .score-container {
            max-width: 400px;
            margin: 0 auto 20px;
            text-align: center;
        }

        .score-label {
            font-size: 48px;
            font-weight: bold;
            color: #2c4563;
            margin-bottom: 5px;
            display: block;
        }

        .score-text {
            color: #666;
            margin-bottom: 15px;
            font-size: 16px;
        }

        .progress-track {
            background: #e0e0e0;
            height: 12px;
            border-radius: 6px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            border-radius: 6px;
            transition: width 1s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .progress-fill.good {
            background: #4caf50;
        }

        .progress-fill.moderate {
            background: #ff9800;
        }

        .progress-fill.bad {
            background: #f44336;
        }

        /* Grid Layout */
        .analysis-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-bottom: 30px;
        }

        .analysis-column h3 {
            color: #2c4563;
            font-size: 18px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Feedback Cards */
        .feedback-card {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 4px solid transparent;
            background: #fff;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            transition: transform 0.2s;
        }

        .feedback-card:hover {
            transform: translateY(-2px);
        }

        .feedback-card.good {
            border-left-color: #4caf50;
            background: #f1f8e9;
        }

        .feedback-card.warning {
            border-left-color: #ff9800;
            background: #fff3e0;
        }

        .feedback-card.bad {
            border-left-color: #f44336;
            background: #ffebee;
        }

        .feedback-content {
            color: #444;
            line-height: 1.5;
            font-size: 15px;
        }


        .product-image {
            width: 60px;
            height: 60px;
            object-fit: contain;
            margin-left: auto;
        }

        .breakdown-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .breakdown-item {
            padding: 15px;
            background: #f9f9f9;
            border-radius: 8px;
        }

        .product-suggestions {
            margin-top: 30px;
        }

        /* Loading */
        .loading {
            text-align: center;
            padding: 40px;
            display: none;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #2c4563;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            display: none;
        }

        /* Mobile Navigation */
        .mobile-nav {
            display: none;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
            padding: 10px 0;
        }

        .mobile-nav-items {
            display: flex;
            justify-content: space-around;
        }

        .mobile-nav-item {
            text-align: center;
            color: #666;
            font-size: 12px;
            padding: 5px;
        }

        .mobile-nav-item.active {
            color: #2c4563;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header-content {
                flex-wrap: wrap;
            }

            .nav {
                display: none;
            }

            .main-section {
                grid-template-columns: 1fr;
            }

            .features {
                grid-template-columns: 1fr;
            }

            .banner-section {
                grid-template-columns: 1fr;
            }

            .mobile-nav {
                display: block;
            }

            body {
                padding-bottom: 70px;
            }
        }
    </style>
    <style>
        /* ... existing styles ... */

        /* Premium Auth Modal Styles */
        .modal {
            backdrop-filter: blur(12px);
            background: rgba(15, 23, 42, 0.6);
            transition: opacity 0.3s ease;
            display: flex;
            /* Ensure flex for centering */
        }

        .auth-card {
            background: var(--glass-bg);
            border-radius: var(--radius-lg);
            width: 100%;
            max-width: 900px;
            /* Wider for split layout */
            height: 600px;
            box-shadow: var(--shadow-lg);
            border: var(--glass-border);
            display: flex;
            overflow: hidden;
            transform: translateY(0);
            transition: transform 0.3s ease;
            position: relative;
        }

        /* Split Layout */
        .auth-visual {
            flex: 1;
            background: linear-gradient(135deg, #2c4563 0%, #1a2a3a 100%);
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            padding: 40px;
            display: none;
            /* Hidden on mobile */
        }

        @media (min-width: 768px) {
            .auth-visual {
                display: flex;
            }
        }

        .auth-visual::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.05'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }

        .auth-visual-content {
            position: relative;
            z-index: 2;
            text-align: center;
        }

        .auth-visual h1 {
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 20px;
            color: #ffc107;
            line-height: 1.1;
        }

        .auth-visual p {
            font-size: 1.1rem;
            opacity: 0.9;
            max-width: 300px;
            line-height: 1.6;
        }

        .auth-form-container {
            flex: 1;
            padding: 50px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            background: white;
        }

        .auth-header {
            text-align: left;
            margin-bottom: 30px;
        }

        .auth-header h2 {
            font-size: 28px;
            color: #1a1a1a;
            margin-bottom: 8px;
            font-weight: 800;
            font-family: 'Plus Jakarta Sans', sans-serif;
        }

        .auth-header p {
            color: #64748b;
            font-size: 16px;
        }

        .auth-tabs {
            display: flex;
            background: #f1f5f9;
            border-radius: 12px;
            padding: 4px;
            margin-bottom: 30px;
        }

        .auth-tab {
            flex: 1;
            padding: 10px;
            border: none;
            background: transparent;
            color: #64748b;
            font-weight: 600;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Outfit', sans-serif;
        }

        .auth-tab.active {
            background: #ffffff;
            color: #2c4563;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .auth-input-group {
            margin-bottom: 20px;
        }

        .auth-input-group label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            font-weight: 500;
            color: #334155;
        }

        .auth-input {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.2s ease;
            background: #f8fafc;
            color: #334155;
            font-family: 'Outfit', sans-serif;
        }

        .auth-input:focus {
            background: white;
            border-color: #2c4563;
            outline: none;
            box-shadow: 0 0 0 3px rgba(44, 69, 99, 0.1);
        }

        .auth-btn {
            width: 100%;
            padding: 16px;
            background: #2c4563;
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            font-family: 'Plus Jakarta Sans', sans-serif;
            margin-top: 10px;
        }

        .auth-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 8px 16px rgba(44, 69, 99, 0.2);
            background: #1e3047;
        }

        .auth-btn:active {
            transform: scale(0.99);
        }

        .logo-placeholder {
            font-size: 80px;
            margin-bottom: 20px;
        }

        /* Inputs & Forms */
        .search-input {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.2s ease;
            background: #f8fafc;
            color: #334155;
            font-family: 'Outfit', sans-serif;
        }

        .search-input:focus {
            background: white;
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 4px rgba(44, 69, 99, 0.1);
        }

        .analyze-btn {
            width: 100%;
            padding: 16px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            font-family: 'Plus Jakarta Sans', sans-serif;
        }

        .analyze-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(44, 69, 99, 0.2);
            background: #1e3047;
        }

        /* Mobile Navigation */
        .mobile-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(12px);
            display: flex;
            justify-content: space-around;
            padding: 15px 0;
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            border-top: 1px solid rgba(0, 0, 0, 0.05);
        }

        .mobile-nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: #94a3b8;
            cursor: pointer;
            transition: all 0.3s;
        }

        .mobile-nav-item.active {
            color: var(--primary);
            transform: translateY(-2px);
        }

        .mobile-nav-item span:first-child {
            font-size: 24px;
            margin-bottom: 4px;
        }

        .mobile-nav-item span:last-child {
            font-size: 12px;
            font-weight: 600;
        }

        @media (min-width: 768px) {
            .mobile-nav {
                display: none;
            }
        }
    </style>
</head>

<body>
    <!-- Header -->
    <div class="header">
        <div class="header-content">
            <div class="logo" onclick="window.location.href='/'" style="cursor: pointer;">
                <img src="/static/logo.png" alt="DUFIL Logo" style="height: 50px;">
            </div>
            <div class="nav">
                <a href="javascript:void(0)" class="active" onclick="showSection('home')">Home</a>
                <a href="javascript:void(0)" onclick="loadHistory()">History</a>
                <a href="javascript:void(0)" onclick="loadProfile()">Profile</a>
            </div>
            <div class="search-box">
                <input type="text" placeholder="Search">
                <span>üîç</span>
            </div>
        </div>
    </div>

    <!-- Main Container -->
    <div class="container">
        <!-- Main Section -->
        <div class="main-section">
            <!-- Upload Card -->
            <div class="upload-card">
                <h1>Analyze Your Meal</h1>
                <p>Your food to get started</p>

                <div class="upload-area" id="uploadArea">
                    <div class="upload-icon-circle">
                        <svg viewBox="0 0 24 24">
                            <path
                                d="M12 8.5c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm0 6c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z" />
                            <path
                                d="M20 5h-3.17L15 3H9L7.17 5H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 14H4V7h4.05l1.83-2h4.24l1.83 2H20v12z" />
                        </svg>
                    </div>
                    <div class="upload-text">Upload Home</div>
                    <div class="upload-formats">or drag and drop image here<br>JPG, PNG, HEIC</div>
                </div>

                <input type="file" id="imageInput" accept="image/*">

                <button class="change-image-btn" onclick="document.getElementById('imageInput').click()"
                    style="width: 100%; display: none;" id="changeImageBtn">+ Change Image</button>

                <div class="action-buttons" style="display: none;" id="mainActions">
                    <button class="btn btn-secondary" onclick="reset()">üè† Basis Home</button>
                    <button class="btn btn-primary" onclick="saveAndAnalyze()">Save Meal</button>
                </div>
            </div>

            <!-- Preview Section -->
            <div class="preview-section" id="previewSection">
                <img id="previewImage" class="preview-image" src="" alt="Food preview">
                <div class="indomie-badge">
                    <span>üçú</span>
                    <span>Indomie & Breakfast</span>
                    <span>‚ñ∂</span>
                </div>
            </div>
        </div>

        <!-- Banner Section -->
        <div class="banner-section">
            <div class="banner-item">
                <h3>Real arrow from</h3>
                <p>Restingas</p>
            </div>
            <div class="banner-item">
                <h3>Favorite village themes</h3>
                <p>Ortstawa</p>
            </div>
        </div>

        <!-- Features -->
        <div class="features">
            <div class="feature-card">
                <h3>Eat<br>Healthy</h3>
            </div>
            <div class="feature-card">
                <h3>Discover<br>New Flavors</h3>
            </div>
            <div class="feature-card">
                <h3>DUFIL<br>Goodness</h3>
            </div>
        </div>

        <!-- Loading -->
        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>Analyzing your meal...</p>
        </div>

        <!-- Error Message -->
        <div class="error-message" id="errorMessage"></div>

        <!-- Ingredients Section -->
        <div class="ingredients-section" id="ingredientsSection">
            <div class="ingredients-header">
                <h2>Ingredients List (Editable)</h2>
                <button class="add-btn" onclick="addIngredient()">+ Add Ingredient</button>
            </div>
            <div id="ingredientsList"></div>
            <div class="reset-save-buttons">
                <button class="icon-btn" onclick="resetIngredients()">
                    <span>üîÑ</span>
                    <span>Reset</span>
                </button>
                <button class="icon-btn" onclick="analyzeHealth()">
                    <span>üíæ</span>
                    <span>Save Meal</span>
                </button>
            </div>
        </div>

        <!-- Analysis Section -->
        <div class="analysis-section" id="analysisSection">
            <div class="analysis-header">
                <h2>Analysis & Suggestions</h2>
                <div id="healthStatusBadge"></div>
            </div>

            <!-- Nutritional Feedback -->
            <div class="feedback-section">
                <h3>Nutritional Feedback (Good or Bad?)</h3>
                <div id="nutritionalFeedback"></div>
            </div>

            <!-- Ingredient Breakdown -->
            <div class="feedback-section">
                <h3>Ingredient Breakdown: Good or Bad?</h3>
                <div class="breakdown-grid" id="ingredientBreakdown"></div>
            </div>

            <!-- Product Suggestions -->
            <div class="product-suggestions">
                <h3>DUFIL & Tolaram Product Suggestions</h3>
                <div id="productSuggestions"></div>
            </div>

            <div class="action-buttons">
                <button class="btn btn-primary" onclick="reset()">üîÑ Analyze Another Meal</button>
            </div>
        </div>
    </div>

    <!-- History Section -->
    <div class="history-section" id="historySection" style="display: none;">
        <div class="analysis-header">
            <h2>Your Food History</h2>
        </div>
        <div class="history-grid" id="historyGrid">
            <!-- History items will be populated here -->
        </div>
    </div>

    <!-- Profile Section -->
    <div class="profile-section" id="profileSection" style="display: none; padding: 20px;">
        <div class="analysis-header">
            <h2>Your Profile</h2>
        </div>
        <div class="upload-card" style="max-width: 500px; margin: 0 auto;">
            <div style="text-align: center; margin-bottom: 20px;">
                <div style="font-size: 50px; margin-bottom: 10px;">üë§</div>
                <h3 id="profileName">User Name</h3>
                <p id="profileEmail" style="color: #666;">user@example.com</p>
            </div>

            <form id="profileForm" onsubmit="saveProfile(event)">
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; color: #2c4563;">Full Name</label>
                    <input type="text" id="p_fullname" class="search-input"
                        style="width: 100%; border: 1px solid #ddd;">
                </div>
                <div style="display: flex; gap: 15px;">
                    <div style="flex: 1; margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px; color: #2c4563;">Age</label>
                        <input type="number" id="p_age" class="search-input"
                            style="width: 100%; border: 1px solid #ddd;">
                    </div>
                    <div style="flex: 1; margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px; color: #2c4563;">Gender</label>
                        <select id="p_gender" class="search-input"
                            style="width: 100%; border: 1px solid #ddd; background: white;">
                            <option value="Male">Male</option>
                            <option value="Female">Female</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                </div>
                <div style="display: flex; gap: 15px;">
                    <div style="flex: 1; margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px; color: #2c4563;">Height (cm)</label>
                        <input type="number" id="p_height" class="search-input"
                            style="width: 100%; border: 1px solid #ddd;">
                    </div>
                    <div style="flex: 1; margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px; color: #2c4563;">Weight (kg)</label>
                        <input type="number" id="p_weight" class="search-input"
                            style="width: 100%; border: 1px solid #ddd;">
                    </div>
                </div>

                <button type="submit" class="analyze-btn" style="width: 100%; margin-top: 10px;">Save Changes</button>
            </form>

            <button onclick="logout()"
                style="width: 100%; margin-top: 30px; background: #ff4757; color: white; border: none; padding: 15px; border-radius: 16px; font-weight: 700; font-size: 16px; cursor: pointer; box-shadow: 0 4px 15px rgba(255, 71, 87, 0.3); transition: transform 0.2s;">
                Log Out
            </button>
        </div>
    </div>

    <!-- Updated Auth Modal -->
    <div id="authModal" class="modal"
        style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1000; justify-content: center; align-items: center;">
        <div class="auth-card">
            <!-- Left Side: Visual -->
            <div class="auth-visual">
                <div class="auth-visual-content">
                    <div class="logo-placeholder">ü•ó</div>
                    <h1>Nutrify</h1>
                    <p>Your personal AI food nutritionist. track, analyze, and improve your diet.</p>
                </div>
            </div>

            <!-- Right Side: Form -->
            <div class="auth-form-container">
                <div class="auth-header">
                    <h2 id="authTitle">Welcome Back</h2>
                    <p>Enter your details to access your account</p>
                </div>

                <div class="auth-tabs">
                    <button id="tabLogin" class="auth-tab active" onclick="switchAuthTab('login')">Login</button>
                    <button id="tabSignup" class="auth-tab" onclick="switchAuthTab('signup')">Sign Up</button>
                </div>

                <form id="authForm" onsubmit="handleAuth(event)">
                    <div id="signupFields" style="display: none;">
                        <div class="auth-input-group">
                            <label>Full Name</label>
                            <input type="text" id="authName" placeholder="e.g. John Doe" class="auth-input">
                        </div>
                    </div>
                    <div class="auth-input-group">
                        <label>Email Address</label>
                        <input type="email" id="authEmail" placeholder="name@example.com" class="auth-input" required>
                    </div>
                    <div class="auth-input-group">
                        <label>Password</label>
                        <input type="password" id="authPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" class="auth-input" required>
                    </div>
                    <button type="submit" class="auth-btn">Continue</button>
                </form>
                <p id="authError"
                    style="color: #ff4757; text-align: center; margin-top: 20px; display: none; background: #fff1f2; padding: 10px; border-radius: 12px; font-size: 14px; font-weight: 500;">
                </p>
            </div>
        </div>
    </div>

    <!-- Mobile Navigation -->
    <div class="mobile-nav">
        <div class="mobile-nav-items">
            <div class="mobile-nav-item active" onclick="showSection('home')">
                <div style="font-size: 24px;">üè†</div>
                <div>Home</div>
            </div>
            <div class="mobile-nav-item" onclick="loadHistory()">
                <div style="font-size: 24px;">üìú</div>
                <div>History</div>
            </div>
            <div class="mobile-nav-item" onclick="loadProfile()">
                <div style="font-size: 24px;">üë§</div>
                <div>Profile</div>
            </div>
        </div>
    </div>

    <!-- Mobile Navigation -->
    <div class="mobile-nav">
        <div class="mobile-nav-item active" onclick="showSection('home')">
            <span>üè†</span>
            <span>Home</span>
        </div>
        <div class="mobile-nav-item" onclick="loadHistory()">
            <span>üìú</span>
            <span>History</span>
        </div>
        <div class="mobile-nav-item" onclick="loadProfile()">
            <span>üë§</span>
            <span>Profile</span>
        </div>
    </div>

    <script>
        const API_URL = 'http://127.0.0.1:5000';
        let currentIngredients = [];
        let currentImage = null;
        let currentImageUrl = '';
        let currentUser = null;
        let authMode = 'login'; // login or signup

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            checkAuth();
        });

        async function checkAuth() {
            try {
                const response = await fetch(`${API_URL}/api/check-auth`);
                const data = await response.json();

                if (data.authenticated) {
                    currentUser = data.user;
                    document.getElementById('authModal').style.display = 'none';
                    updateProfileUI();
                } else {
                    document.getElementById('authModal').style.display = 'flex';
                }
            } catch (error) {
                console.error('Auth check failed:', error);
            }
        }

        function switchAuthTab(mode) {
            authMode = mode;
            document.getElementById('authError').style.display = 'none';

            const loginBtn = document.getElementById('tabLogin');
            const signupBtn = document.getElementById('tabSignup');

            // Reset both styles first (remove inline styles from previous version if any remain, though classes handle it primarily)
            loginBtn.style = '';
            signupBtn.style = '';

            if (mode === 'login') {
                loginBtn.classList.add('active');
                signupBtn.classList.remove('active');
                document.getElementById('signupFields').style.display = 'none';
                document.getElementById('authTitle').innerText = 'Welcome Back';
            } else {
                signupBtn.classList.add('active');
                loginBtn.classList.remove('active');
                document.getElementById('signupFields').style.display = 'block';
                document.getElementById('authTitle').innerText = 'Create Account';
            }
        }

        async function handleAuth(e) {
            e.preventDefault();
            const email = document.getElementById('authEmail').value;
            const password = document.getElementById('authPassword').value;
            const fullName = document.getElementById('authName').value;
            const errorElement = document.getElementById('authError');

            errorElement.style.display = 'none';

            const endpoint = authMode === 'login' ? '/api/login' : '/api/signup';
            const body = { email, password };
            if (authMode === 'signup') body.full_name = fullName;

            try {
                const response = await fetch(`${API_URL}${endpoint}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(body)
                });

                const data = await response.json();

                if (data.success) {
                    currentUser = data.user;
                    document.getElementById('authModal').style.display = 'none';
                    updateProfileUI();
                    if (authMode === 'signup') {
                        // Maybe show onboarding or just let them into app
                        alert('Account created successfully!');
                    }
                } else {
                    errorElement.innerText = data.error || 'Authentication failed';
                    errorElement.style.display = 'block';
                }
            } catch (error) {
                errorElement.innerText = 'Network error';
                errorElement.style.display = 'block';
            }
        }

        async function logout() {
            try {
                await fetch(`${API_URL}/api/logout`, { method: 'POST' });
                currentUser = null;
                document.getElementById('authModal').style.display = 'flex';
                switchAuthTab('login');
                showSection('home');
            } catch (error) {
                console.error('Logout failed:', error);
            }
        }

        function loadProfile() {
            showSection('profile');
            if (currentUser) {
                document.getElementById('p_fullname').value = currentUser.full_name || '';
                document.getElementById('p_age').value = currentUser.age || '';
                document.getElementById('p_height').value = currentUser.height || '';
                document.getElementById('p_weight').value = currentUser.weight || '';
                document.getElementById('p_gender').value = currentUser.gender || 'Male';
            }
        }

        function updateProfileUI() {
            if (currentUser) {
                // Update simpler display elements if any
                document.getElementById('profileName').innerText = currentUser.full_name || 'User';
                document.getElementById('profileEmail').innerText = currentUser.email || '';
            }
        }

        async function saveProfile(e) {
            e.preventDefault();
            const updates = {
                full_name: document.getElementById('p_fullname').value,
                age: document.getElementById('p_age').value,
                height: document.getElementById('p_height').value,
                weight: document.getElementById('p_weight').value,
                gender: document.getElementById('p_gender').value
            };

            try {
                const response = await fetch(`${API_URL}/api/profile`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(updates)
                });

                const data = await response.json();
                if (data.success) {
                    alert('Profile updated successfully!');
                    // Update local user object
                    currentUser = { ...currentUser, ...updates };
                    updateProfileUI();
                } else {
                    alert('Failed to update profile: ' + data.error);
                }
            } catch (error) {
                alert('Error connecting to server');
            }
        }

        // Setup upload functionality
        const uploadArea = document.getElementById('uploadArea');
        const imageInput = document.getElementById('imageInput');

        uploadArea.addEventListener('click', () => imageInput.click());

        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragging');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragging');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragging');
            const file = e.dataTransfer.files[0];
            if (file && file.type.startsWith('image/')) {
                handleImageUpload(file);
            }
        });

        imageInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                handleImageUpload(file);
            }
        });

        async function handleImageUpload(file) {
            currentImage = file;
            showLoading(true);
            hideError();

            // Show preview
            const reader = new FileReader();
            reader.onload = (e) => {
                document.getElementById('previewImage').src = e.target.result;
                document.getElementById('previewSection').style.display = 'block';
                document.getElementById('changeImageBtn').style.display = 'block';
                document.getElementById('mainActions').style.display = 'flex';
                // Hide upload area slightly to focus on preview
                document.querySelector('.upload-card p').style.display = 'none';
            };
            reader.readAsDataURL(file);

            // Upload and analyze
            const formData = new FormData();
            formData.append('image', file);

            try {
                const response = await fetch(`${API_URL}/api/analyze-food`, {
                    method: 'POST',
                    body: formData
                });

                const data = await response.json();

                if (data.success) {
                    currentIngredients = data.ingredients;
                    currentImageUrl = data.image_url; // Save Image URL
                    displayIngredients();
                    document.getElementById('ingredientsSection').style.display = 'block';
                    // Scroll to ingredients
                    document.getElementById('ingredientsSection').scrollIntoView({ behavior: 'smooth' });
                } else {
                    showError(data.error || 'Failed to analyze image');
                }
            } catch (error) {
                showError('Error connecting to server: ' + error.message);
            } finally {
                showLoading(false);
            }
        }

        function displayIngredients() {
            const list = document.getElementById('ingredientsList');
            list.innerHTML = '';

            currentIngredients.forEach((ingredient, index) => {
                const item = document.createElement('div');
                item.className = 'ingredient-item';
                item.innerHTML = `
                    <input type="text" value="${ingredient}" onchange="updateIngredient(${index}, this.value)" id="ingredient-${index}">
                    <span class="edit-icon" onclick="document.getElementById('ingredient-${index}').focus()">‚úèÔ∏è</span>
                `;
                list.appendChild(item);
            });
        }

        function updateIngredient(index, value) {
            currentIngredients[index] = value;
        }

        function addIngredient() {
            currentIngredients.push('New Ingredient');
            displayIngredients();
        }

        function resetIngredients() {
            if (confirm('Are you sure you want to reset all ingredients?')) {
                displayIngredients();
            }
        }

        function saveAndAnalyze() {
            analyzeHealth();
        }

        async function analyzeHealth() {
            if (currentIngredients.length === 0) {
                showError('Please add at least one ingredient');
                return;
            }

            showLoading(true);
            hideError();

            try {
                const response = await fetch(`${API_URL}/api/analyze-health`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        ingredients: currentIngredients,
                        image_url: currentImageUrl
                    })
                });

                const data = await response.json();

                if (data.success) {
                    displayAnalysis(data.analysis);
                    document.getElementById('analysisSection').style.display = 'block';
                    document.getElementById('analysisSection').scrollIntoView({ behavior: 'smooth' });
                } else {
                    showError(data.error || 'Failed to analyze health');
                }
            } catch (error) {
                showError('Error connecting to server: ' + error.message);
            } finally {
                showLoading(false);
            }
        }

        function displayAnalysis(analysis) {
            // Health Score & Circle
            const statusBadge = document.getElementById('healthStatusBadge');
            const scoreColor = analysis.overall_health_status === 'good' ? 'good' :
                (analysis.overall_health_status === 'moderate' ? 'moderate' : 'bad');

            statusBadge.innerHTML = `
                <div class="score-container">
                    <span class="score-label" style="color: var(--${scoreColor})">${analysis.health_score}</span>
                    <div class="score-text">${analysis.analysis}</div>
                    <div class="progress-track">
                        <div class="progress-fill ${scoreColor}" style="width: ${analysis.health_score}%"></div>
                    </div>
                </div>
            `;

            // Setup Grid
            const feedbackDiv = document.getElementById('nutritionalFeedback');
            const breakdownDiv = document.getElementById('ingredientBreakdown');

            // Clear previous content and ensure we don't have duplicate grids
            const existingGrid = document.querySelector('.analysis-grid');
            if (existingGrid) {
                existingGrid.remove();
            }

            const gridContainer = document.createElement('div');
            gridContainer.className = 'analysis-grid';

            // Column 1: The Good Stuff
            const goodCol = document.createElement('div');
            goodCol.className = 'analysis-column';
            goodCol.innerHTML = '<h3>‚ú® The Good Stuff</h3>';

            analysis.nutritional_highlights.forEach(highlight => {
                goodCol.innerHTML += `
                    <div class="feedback-card good">
                        <div class="feedback-content">‚úì ${highlight}</div>
                    </div>
                `;
            });
            gridContainer.appendChild(goodCol);

            // Column 2: Watch Out For
            const badCol = document.createElement('div');
            badCol.className = 'analysis-column';
            badCol.innerHTML = '<h3>‚ö†Ô∏è Watch Out For</h3>';

            if (analysis.health_concerns && analysis.health_concerns.length > 0) {
                analysis.health_concerns.forEach(concern => {
                    badCol.innerHTML += `
                        <div class="feedback-card bad">
                            <div class="feedback-content">‚úï ${concern}</div>
                        </div>
                    `;
                });
            } else {
                badCol.innerHTML += `
                    <div class="feedback-card good">
                        <div class="feedback-content">No major concerns identified!</div>
                    </div>
                `;
            }
            gridContainer.appendChild(badCol);

            // We want to insert this after the header
            const header = document.querySelector('.analysis-header');
            // Check if we are in view mode or analyze mode, handle insertion safely
            const analysisSection = document.getElementById('analysisSection');
            const existingHeader = analysisSection.querySelector('.analysis-header');
            if (existingHeader) {
                existingHeader.after(gridContainer);
            }


            // Product Suggestions
            const suggestionsDiv = document.getElementById('productSuggestions');
            suggestionsDiv.innerHTML = '';

            analysis.dufil_products.forEach(product => {
                suggestionsDiv.innerHTML += `
                    <div class="feedback-card good">
                        <div class="feedback-title" style="font-weight:bold; margin-bottom:5px;">${product.product_name}</div>
                        <div class="feedback-content">
                            ${product.reason} <br>
                            <small>Benefit: ${product.benefit}</small>
                        </div>
                    </div>
                `;
            });

            analysis.tolaram_products.forEach(product => {
                suggestionsDiv.innerHTML += `
                    <div class="feedback-card good">
                       <div class="feedback-title" style="font-weight:bold; margin-bottom:5px;">${product.product_name}</div>
                        <div class="feedback-content">
                            ${product.usage} <br>
                            <small>Benefit: ${product.benefit}</small>
                        </div>
                    </div>
                `;
            });
        }

        async function loadHistory() {
            showSection('history');
            const historyGrid = document.getElementById('historyGrid');
            historyGrid.innerHTML = '<div class="loading" style="display:block"><div class="spinner"></div><p>Loading history...</p></div>';

            try {
                const response = await fetch(`${API_URL}/api/history`);
                const data = await response.json();

                if (data.success) {
                    historyGrid.innerHTML = '';
                    if (data.history.length === 0) {
                        historyGrid.innerHTML = '<p style="text-align:center; padding:20px; color:#666">No history found yet.</p>';
                        return;
                    }

                    data.history.forEach(item => {
                        const date = new Date(item.timestamp).toLocaleDateString();
                        const time = new Date(item.timestamp).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                        const score = item.analysis.health_score;
                        const status = item.analysis.overall_health_status;
                        const scoreColor = status === 'good' ? '#4caf50' : (status === 'moderate' ? '#ff9800' : '#f44336');
                        const imageUrl = item.image_url || 'https://placehold.co/100?text=Food'; // Fallback if no image

                        // Pass image_url to viewHistoryItem
                        const itemData = encodeURIComponent(JSON.stringify(item));

                        historyGrid.innerHTML += `
                            <div class="upload-card" style="cursor:pointer; display:flex; align-items:center; gap:15px; padding:15px" 
                                onclick='viewHistoryItem("${itemData}")'>
                                
                                <div style="position:relative; width:80px; height:80px; flex-shrink:0;">
                                    <img src="${imageUrl}" style="width:100%; height:100%; object-fit:cover; border-radius:10px;">
                                    <div style="position:absolute; bottom:-5px; right:-5px; background:${scoreColor}; color:white; width:30px; height:30px; border-radius:50%; display:flex; alignItems:center; justify-content:center; font-weight:bold; font-size:12px; border:2px solid white;">
                                        ${score}
                                    </div>
                                </div>
                                
                                <div style="flex:1">
                                    <div style="font-weight:bold; color:#2c4563; margin-bottom:5px">${date} - ${time}</div>
                                    <p style="margin:0; font-size:14px; color:#666; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">
                                        ${item.analysis.analysis}
                                    </p>
                                </div>
                                
                                <div style="color:#ccc; font-size:20px">‚Ä∫</div>
                            </div>
                        `;
                    });
                }
            } catch (error) {
                historyGrid.innerHTML = `<p style="color:red; text-align:center">Error loading history: ${error.message}</p>`;
            }
        }

        function viewHistoryItem(itemDataEncoded) {
            const item = JSON.parse(decodeURIComponent(itemDataEncoded));
            const analysis = item.analysis;

            showSection('home');

            // Set image
            if (item.image_url) {
                document.getElementById('previewImage').src = item.image_url;
                document.getElementById('previewSection').style.display = 'block';
                // Hide upgrade/change buttons since it's history
                document.getElementById('changeImageBtn').style.display = 'none';
                document.getElementById('mainActions').style.display = 'none';
            } else {
                document.getElementById('previewSection').style.display = 'none';
            }

            document.getElementById('analysisSection').style.display = 'block';
            displayAnalysis(analysis);
            document.getElementById('analysisSection').scrollIntoView({ behavior: 'smooth' });

            // Hide ingredients part as we are viewing result
            document.getElementById('ingredientsSection').style.display = 'none';
        }

        function showSection(section) {
            // Simple router-like visibility toggle
            if (section === 'history') {
                document.querySelector('.main-section').style.display = 'none';
                document.querySelector('.banner-section').style.display = 'none';
                document.querySelector('.features').style.display = 'none';
                document.getElementById('historySection').style.display = 'block';
                document.getElementById('analysisSection').style.display = 'none';
                document.getElementById('profileSection').style.display = 'none';

                // Update Nav Active State
                document.querySelectorAll('.mobile-nav-item').forEach(el => el.classList.remove('active'));
                document.querySelectorAll('.mobile-nav-item')[1].classList.add('active'); // History is index 1

            } else if (section === 'profile') {
                document.querySelector('.main-section').style.display = 'none';
                document.querySelector('.banner-section').style.display = 'none';
                document.querySelector('.features').style.display = 'none';
                document.getElementById('historySection').style.display = 'none';
                document.getElementById('analysisSection').style.display = 'none';
                document.getElementById('profileSection').style.display = 'block';

                // Update Nav Active State
                document.querySelectorAll('.mobile-nav-item').forEach(el => el.classList.remove('active'));
                document.querySelectorAll('.mobile-nav-item')[2].classList.add('active'); // Profile is index 2

            } else {
                document.querySelector('.main-section').style.display = 'grid'; // Restore grid
                document.querySelector('.banner-section').style.display = 'grid';
                document.querySelector('.features').style.display = 'grid';
                document.getElementById('historySection').style.display = 'none';
                document.getElementById('profileSection').style.display = 'none';

                document.querySelectorAll('.mobile-nav-item').forEach(el => el.classList.remove('active'));
                document.querySelectorAll('.mobile-nav-item')[0].classList.add('active'); // Home is index 0
            }
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function reset() {
            currentIngredients = [];
            currentImage = null;
            currentImageUrl = '';
            document.getElementById('previewSection').style.display = 'none';
            document.getElementById('ingredientsSection').style.display = 'none';
            document.getElementById('analysisSection').style.display = 'none';
            document.getElementById('changeImageBtn').style.display = 'none';
            document.getElementById('mainActions').style.display = 'none';
            document.querySelector('.upload-card p').style.display = 'block'; // Show placeholder text
            imageInput.value = '';
            hideError();
            showSection('home');
        }

        function showLoading(show) {
            document.getElementById('loading').style.display = show ? 'block' : 'none';
        }

        function showError(message) {
            const errorDiv = document.getElementById('errorMessage');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
        }

        function hideError() {
            document.getElementById('errorMessage').style.display = 'none';
        }
    </script>
</body>

</html>